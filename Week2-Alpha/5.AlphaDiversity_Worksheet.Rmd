---
title: '5\. Worksheet: Alpha Diversity'
author: "Anna Lennon"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
geometry: margin = 2.54cm
---

## OVERVIEW

In this exercise, we will explore aspects of local or site-specific diversity, also known as alpha ($\alpha$) diversity. 
First we will quantify two of the fundamental components of ($\alpha$) diversity: **richness** and **evenness**.
From there, we will then discuss ways to integrate richness and evenness, which will include univariate metrics of diversity along with an investigation of the **species abundance distribution (SAD)**.

## Directions:
1. In the Markdown version of this document in your cloned repo, change "Student Name" on line 3 (above) to your name.
2. Complete as much of the worksheet as possible during class.
3. Use the handout as a guide; it contains a more complete description of data sets along with the proper scripting needed to carry out the exercise.
4. Answer questions in the worksheet.
Space for your answer is provided in this document and indicated by the ">" character.
If you need a second paragraph be sure to start the first line with ">".
You should notice that the answer is highlighted in green by RStudio (color may vary if you changed the editor theme).
5. Before you leave the classroom, **push** this file to your GitHub repo.
6. For the assignment portion of the worksheet, follow the directions at the bottom of this file. 
7. When you are done, **Knit** the text and code into a PDF file.
8. After Knitting, submit the completed exercise by creating a **pull request** via GitHub.
Your pull request should include this file `AlphaDiversity_Worskheet.Rmd` and the PDF output of `Knitr` (`AlphaDiversity_Worskheet.pdf`).

## 1) R SETUP

In the R code chunk below, please provide the code to: 
1) Clear your R environment,
2) Print your current working directory,
3) Set your working directory to your `Week-2/` folder folder, and
4) Load the `vegan` R package (be sure to install first if you have not already).

```{r}
rm(list = ls())
getwd()
#cd ./cloud/project/QB2025_ALennon/Week2-Alpha
#install.packages("vegan")
library(vegan)
```

## 2) LOADING DATA

In the R code chunk below, do the following:
1) Load the BCI dataset, and 
2) Display the structure of the dataset (if the structure is long, use the `max.level = 0` argument to show the basic information).

```{r}
data(BCI)
str(BCI) #str(BCI, max.level = 0)
```

## 3) SPECIES RICHNESS

**Species richness (S)** refers to the number of species in a system or the number of species observed in a sample.

### Observed richness

In the R code chunk below, do the following:

1. Write a function called `S.obs` to calculate observed richness

2. Use your function to determine the number of species in `site1` of the BCI data set, and

3. Compare the output of your function to the output of the `specnumber()` function in `vegan`.

```{r}

S.obs <- function(x = ""){
   rowSums(x > 0) *1 
   }
print(S.obs)

print(BCI)

site1.sum.f <- S.obs(BCI[1,])

site1.sum.v <- specnumber(BCI[1,])

print(paste("Vegan=", site1.sum.v))
print(paste("Function=", site1.sum.f))
###
site4.sum.f <- S.obs(BCI[1:4,])

site4.sum.v <- specnumber(BCI[1:4,])

print(paste("Vegan=", site4.sum.v))
print(paste("Function=", site4.sum.f))




```

***Question 1***: Does `specnumber()` from `vegan` return the same value for observed richness in `site1` as our function `S.obs`?
What is the species richness of the first four sites (i.e., rows) of the BCI matrix?

> ***Answer 1***:
>The vegan library "specnumber()" output is the same as the same as the written function. For Site 1, the species richness is 93, Site 2 is 84, Site 3 is 90, and Site 4 is 94


### Coverage: How well did you sample your site?

In the R code chunk below, do the following:

1. Write a function to calculate Good's Coverage, and

2. Use that function to calculate coverage for all sites in the BCI matrix.

```{r}
GC <- function (x = ""){1- (rowSums(x ==1)/rowSums(x))}
GC_all <- GC(BCI)
print(GC_all)

GC.df <-data.frame(GC_all)
print(GC.df)
range(GC.df)
max(GC.df)

```
  
***Question 2***: Answer the following questions about coverage:

a.  What is the range of values that can be generated by Good's Coverage? 
b.  What would we conclude from Good's Coverage if $n_{i}$ equaled *N*?
c.  What portion of taxa in `site1` was represented by singletons? 
d.  Make some observations about coverage at the BCI plots.

> ***Answer 2a***:
>Good's Coverage results in values <1. For the BCI dataset, the range of values was [.8706, .9469]. 

> ***Answer 2b***:
>If n1 = N in Good's Coverage, then the coverage would equal to zero. This would insinuate that all the taxa sampled are singleton species and all organisms found in the population are rare. Therefore, the sample is extremely diverse or there is a potential for sampling error given the high number of rare taxa.

> ***Answer 2c***: 
>From calculating Good's Coverage for the BCI dataset, .9308 (93.08%) of the taxa at Site 1 are singletons.

> ***Answer 2d***: 
>Given that the range of singletons is 87.06% to 94.69%, a majority of taxa represented in the BCI at each site is singletons. Therefore, the samples are rich in biodiversity but low in evenness. 


### Estimated richness

In the R code chunk below, do the following:

1. Load the microbial dataset (located in the `Week-2/data` folder),

2. Transform and transpose the data as needed (see handout),

3. Create a new vector (`soilbac1`) by indexing the bacterial OTU abundances of any site in the dataset,

4. Calculate the observed richness at that particular site, and 

5. Calculate coverage of that site

```{r}
soil.bac <-read.table("data/soilbac.txt", sep = "\t", header =TRUE, row.names =1)
print(soil.bac)
soil.bac.t <-as.data.frame(t(soil.bac))
soilbac1 <-soil.bac.t[1,]
print(soilbac1)
soilbac1.r <-S.obs(soilbac1)
print(soilbac1.r)

GC.soilbac1 <- GC(soilbac1)


BCI.1 <-BCI[1,]

GC.BCI.1 <-GC(BCI.1)
print(paste("KBS:", GC.soilbac1))
print(paste("BCI:", GC.BCI.1))





```

***Question 3***: Answer the following questions about the soil bacterial dataset. 

a.  How many sequences did we recover from the sample `soilbac1`, i.e. *N*? 
b.  What is the observed richness of `soilbac1`? 
c.  How does coverage compare between the BCI sample (`site1`) and the KBS sample (`soilbac1`)?

> ***Answer 3a***:
>There were 19 total indviduals recovered. 

> ***Answer 3b***: 
>1302 species

> ***Answer 3c***: 
>The KBS dataset has signifcantly less singletons present (66.77%) compared to BCI (92.87%) at Site 2. Therefore, there are more rare species in the BCI dataset. 


### Richness estimators

In the R code chunk below, do the following:

1. Write a function to calculate **Chao1**,

2. Write a function to calculate **Chao2**, 

3. Write a function to calculate **ACE**, and

4. Use these functions to estimate richness at `site1` and `soilbac1`. 

```{r}
#abundance
chao1 <- function(x ="") {
  S.obs(x) + (sum(x==1)^2)/(2*sum(x ==2))
} 
#incidence
chao2 <- function(site = "", SbyS = "") {
  SbyS = as.data.frame(SbyS)
  x = SbyS[site,]
  SbyS.pa <- (SbyS >0) *1
  Q1 = sum(colSums(SbyS.pa) ==1)
  Q2 = sum(colSums(SbyS.pa) ==2)
  chao2 = S.obs(x) +(Q1^2)/(2*Q2)
  return(chao2)
}


#abundance coverage
ace <- function (x = "", thresh =10){
  x <- x[x >0]
  S.abund <-length(which (x > thresh))
  S.rare <- length(which (x <= thresh))
  singlt <- length(which (x ==1))
  N.rare <-sum(x[which (x <= thresh)])
  C.ace <-1-(singlt/N.rare)
  i <- c(1:thresh)
  count <- function (i, y){
    length(y[y == i])
  }
  a.1 <- sapply(i, count, x)
  f.1 <-(i * (i-1))*a.1
  G.ace <- (S.rare/C.ace)*(sum(f.1)/(N.rare*(N.rare-1)))
  S.ace <- S.abund +(S.rare/C.ace) +(singlt/C.ace) *max(G.ace,0)
  return(S.ace)
}

chao1.S1 <- chao1(BCI.1)
chao2.S1 <- chao2(1, BCI)
ace.S1 <-ace(BCI.1)

chao1.soilbac <- chao1(soilbac1)
chao2.soilbac <- chao2(1, soil.bac.t)
ace.soilbac <-ace(soilbac1)

#Output DF
result_df <- data.frame(
  Dataset = c("BCI", "Soil Bac"),
  Chao1 = c(chao1.S1, chao1.soilbac),
  Chao2 = c(chao2.S1, chao2.soilbac),
  ACE = c(ace.S1, ace.soilbac)
)


print(result_df)

```

***Question 4***: 
What is the difference between ACE and the Chao estimators? 
Do the estimators give consistent results? 
Which one would you choose to use and why?

> ***Answer 4***:
>ACE estimator is an abundance-based coverage estimator compared to Chao1 which is also an abundance estimator. However, the key difference between the estimators is that Chao1 is based on the number of singletons and doubletons comapred to ACE that has a threshold of rare species (10) making it less effective for data with high levels of small populations of rare species. Therefore, Chao estimators should be used for data with many species with few indviduals per species. When applied to the BCI and Soil Bacteria, the different richness estimators provide a wide variety of results (results_df). 


### Rarefaction

In the R code chunk below, please do the following:

1. Calculate observed richness for all samples in `soilbac`,

2. Determine the size of the smallest sample,

3. Use the `rarefy()` function to rarefy each sample to this level,

4. Plot the rarefaction results, and

5. Add the 1:1 line and label.


```{r}
print(soil.bac.t)
soilbact.obsrich <- S.obs(soil.bac.t)
#smallest sample
min.N <- min(rowSums(soil.bac.t))
print(min.N)
#rarefy
S.rarefy <-rarefy(x = soil.bac.t, sample = min.N, se = TRUE)
rarecurve(x = soil.bac.t, step = 20, col = "deepskyblue", cex = .6, las =1)
abline (0,1, col = "darkgreen")
text(1500, 1500, "1:1", pos =2, col = "darkgreen")

```


## 4) SPECIES EVNENNESS
Here, we consider how abundance varies among species, that is, **species evenness**.

### Visualizing evenness: the rank abundance curve (RAC)
One of the most common ways to visualize evenness is in a **rank-abundance curve** (sometime referred to as a rank-abundance distribution or Whittaker plot).
An RAC can be constructed by ranking species from the most abundant to the least abundant without respect to species labels (and hence no worries about 'ties' in abundance). 

In the R code chunk below, do the following:

1. Write a function to construct a RAC,

2. Be sure your function removes species that have zero abundances, 

3. Order the vector (RAC) from greatest (most abundant) to least (least abundant), and 

4. Return the ranked vector

```{r}
RAC <-function (x = "") {
  x.ab = x[x>0] #removes zero abundances
  x.ab.ranked = x.ab[order(x.ab, decreasing = TRUE)] #order vector
  as.data.frame(lapply(x.ab.ranked, unlist))
  return(x.ab.ranked) #return ranked vector
}
```

Now, let us examine the RAC for `site1` of the BCI data set.

In the R code chunk below, do the following:

1. Create a sequence of ranks and plot the RAC with natural-log-transformed abundances,

2. Label the x-axis "Rank in abundance" and the y-axis "log(abundance)"

```{r}
plot.new()
site1.BCI <-BCI[1,]

rac <- RAC(x =site1.BCI)
ranks <-as.vector(seq(1, length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1, 5.1, 4.1, 2.1))
plot(ranks, log(rac), type = "p", axes =F,
     xlab = "Rank in abundance",
     ylab = "log(abundance)",
     las =1, cex.lab = 1.4, cex.axis =1.25)
box()
axis(side = 1, labels = T, cex.axis =1.25)
axis(side = 2, las = 1, cex.axis =1.25,
     labces = c(1,2,5,10,20), at = log(c(1,2,5,10,20)))
par <-opar
```

***Question 5***: What effect does visualizing species abundance data on a log-scaled axis have on how we interpret evenness in the RAC?

> ***Answer 5***:
By utilizing a log-scaled axis, eveness is more easily observed than in a simple linear regression. With a long-scaled axis, distict clusters form creating a stark contrast between evenly distributed data, such as the clusters formed around 80 as compared to the being dominated by a few species, such as the data between 0-20 on "Rank in abundance".

Now that we have visualized unevennes, it is time to quantify it using Simpson's evenness ($E_{1/D}$) and Smith and Wilson's evenness index ($E_{var}$).

### Simpson's evenness ($E_{1/D}$)

In the R code chunk below, do the following:

1. Write the function to calculate $E_{1/D}$, and

2. Calculate $E_{1/D}$ for `site1`.

```{r}
#Simpson's Evenness- rank-abundance curve
simpE <- function (x = ""){
  S <-S.obs(x)
  x = as.data.frame(x)
  D <- diversity(x,"inv")
  E = (D)/S
  return(E)
}
site1.BCI <-BCI[1,]
simpe.site1 <- simpE(site1.BCI)

```

### Smith and Wilson's evenness index ($E_{var}$)

In the R code chunk below, please do the following:

1. Write the function to calculate $E_{var}$,

2. Calculate $E_{var}$ for `site1`, and

3. Compare $E_{1/D}$ and $E_{var}$.

```{r}
Evar <- function(x){
  x <-as.vector(x[x >0])
  1-(2/pi)*atan(var(log(x)))
}
site1.evar <-Evar(site1.BCI)
print(site1.evar)
print(simpe.site1)

```

***Question 6***: Compare estimates of evenness for `site1` of BCI using $E_{1/D}$ and $E_{var}$.
Do they agree? If so, why? If not, why? What can you infer from the results.

> ***Answer 6***:The Smith and Wilson's Evenness index is .5067 compared to the Simpson's evenness index which is .4238. While roughly (within .1 of one another) similar, Simpson's evennness is extremely sensitive to abundant species compared to Smith and Wilson's index. Therefore, the evenness at Site 1 is only about 50% even, whcih means that there is still half of the population with great variety in abundance. 


## 5) INTEGRATING RICHNESS AND EVENNESS: DIVERSITY METRICS

So far, we have introduced two primary aspects of diversity, i.e., richness and evenness.
Here, we will use popular indices to estimate diversity, which explicitly incorporate richness and evenness.
We will write our own diversity functions and compare them against the functions in `vegan`. 

### Shannon's diversity (a.k.a., Shannon's entropy)

In the R code chunk below, please do the following:

1. Provide the code for calculating H' (Shannon's diversity),

2. Compare this estimate with the output of `vegan`'s diversity function using method = "shannon".

```{r}
shanH <-function (x = ""){
  H =0
  for (n_i in x){
    if (n_i > 0) {
      p = n_i/sum(x)
      H = H-p*log(p)
    }
  }
  return(H)
}

shanH(site1.BCI)
diversity(site1.BCI, index = "shannon")
```

### Simpson's diversity (or dominance)

In the R code chunk below, please do the following:

1. Provide the code for calculating D (Simpson's diversity),

2. Calculate both the inverse (1/D) and 1 - D,

2. Compare this estimate with the output of `vegan's` diversity function using method = "simp".

```{r}
SimpD = function(x = ""){
  D=0
  N=sum(x)
  for (n_i in x){
    D =D +(n_i^2)/(N^2)
  }
  return(D)
}

D.inv <-1/SimpD(site1.BCI)
D.sub <-1-SimpD(site1.BCI)
print(D.inv)
print(D.sub)

#vegan
diversity(site1.BCI, "inv")
diversity(site1.BCI, "simp")

```

### Fisher's $\boldsymbol\alpha$

In the R code chunk below, please do the following:

1. Provide the code for calculating Fisher's $\boldsymbol\alpha$,

2. Calculate Fisher's $\boldsymbol\alpha$ for `site1` of BCI.

```{r}
rac <-as.vector(site1.BCI[site1.BCI>0])
invD <- diversity(rac, "inv")
invD

Fisher <-fisher.alpha(rac)
Fisher

```

***Question 7***: 
How is Fisher's $\boldsymbol\alpha$ different from $E_{H'}$ and $E_{var}$? 
What does Fisher's $\boldsymbol\alpha$ take into account that $E_{H'}$ and $E_{var}$ do not?

> ***Answer 7***: Fisher's alpha is 39.416 (or 35.672 from vegan package) comapred to H which is 4.018 and Smith and Wilson's evenness index which is .5067. Unlike the other metrics, Fisher's alpha estimates diversity, which includes sampling error. The other metrics aim to calculate diversity and do not take any error into account. 

## 6) HILL NUMBERS 

Remember that we have learned about the advantages of Hill Numbers to measure and compare diversity among samples. 
We also learned to explore the effects of rare species in a community by examining diversity for a series of exponents $q$. 

***Question 8***: Using `site1` of BCI and `vegan` package, a) calculate Hill numbers for $q$ exponent 0, 1 and 2 (richness, exponential Shannon's entropy, and inverse Simpson's diversity). b) Interpret the effect of rare species in your community based on the response of diversity to increasing exponent $q$. 
```{r}
#site1.BCI
library(vegan)
tsallis(site1.BCI, scales = seq(0,2,1), hill=TRUE)
q_0 = S.obs(site1.BCI)
q_1 = exp(diversity(site1.BCI, index="shannon"))
q_2 = diversity(site1.BCI, index="invsimpson")

hill.df <- data.frame(
  Order = c("q0 (Species Richness)", "q1 (Shannon Diversity)", "q2 (Inverse Simpson)"),
  Hill_number = c(q_0, q_1, q_2)
)
print(hill.df)

```

> ***Answer 8a***:
> For the Hill numbers of Site 1 in the BCI data base is when q = 0, the richness is 93.00, the Shannon Diversity when q =1 is 55.613 and the Inverse Simpson at q =2 is 39.416. 
> ***Answer 8b***:
>As q increases, the species diversity drops going from 93.00 (q=0) to 39.42 (q =2). Therefore, rare species signficantly impact overall species richness (q=0) and that the community is composed of many rare species. 

##7) MOVING BEYOND UNIVARIATE METRICS OF $\alpha$ DIVERSITY

The diversity metrics that we just learned about attempt to integrate richness and evenness into a single, univariate metric.
Although useful, information is invariably lost in this process. 
If we go back to the rank-abundance curve, we can retrieve additional information -- and in some cases -- make inferences about the processes influencing the structure of an ecological system.

## Species abundance models

The RAC is a simple data structure that is both a vector of abundances.
It is also a row in the site-by-species matrix (minus the zeros, i.e., absences). 

Predicting the form of the RAC is the first test that any biodiversity theory must pass and there are no less than 20 models that have attempted to explain the uneven form of the RAC across ecological systems.

In the R code chunk below, please do the following:

1. Use the `radfit()` function in the `vegan` package to fit the predictions of various species abundance models to the RAC of `site1` in BCI,

2. Display the results of the `radfit()` function, and 

3. Plot the results of the `radfit()` function using the code provided in the handout.

```{r}
RAC.site1.BCI <- radfit(site1.BCI)
print(RAC.site1.BCI)

plot.new()
plot(RAC.site1.BCI, las = 1, cex.lab = 1.4, cex.axis = 1.25)

```


***Question 9***: Answer the following questions about the rank abundance curves:
a) Based on the output of `radfit()` and plotting above, discuss which model best fits our rank-abundance curve for `site1`?
b) Can we make any inferences about the forces, processes, and/or mechanisms influencing the structure of our system, e.g., an ecological community?

> ***Answer 9a***: 
>Based on the output, Mandelbrot would be the most appropriate and has the best fit for site 1 in the BCI database. With a deviance of 4.227, it has the lowest amount of variance not explained by the model compared to the other models, such as Zipf (D= 61.04). Graphically, Mandelbrot also visually fits the best following a subtle curve. 
> ***Answer 9b***:
>Given that Mandelbrot is the most appropriate model, there are a few inferences that can be made regarding the community. Communities taht fit under the Mandelbrot model follow the power-law pattern or having high richness of a few abundant species and many less abundant species potentially resulting in niche paritioning. Niche partioning allows species with similar niches to cohabitate in the same ecosystem especially as it concerns the less rare species. Additionally, abundance could be a result of newer species having particular niche requirements allowing them to survive and thrive in a rare niche. 
Citation: https://myweb.ttu.edu/nmcintyr/Community%20Ecology/abundance.docx


***Question 10***: Answer the following questions about the preemption model:
a.  What does the preemption model assume about the relationship between total abundance (*N*) and total resources that can be preempted?
b.  Why does the niche preemption model look like a straight line in the RAD plot?

> ***Answer 10a***: 
>The preemption model assumes that earlier species limit resources for late arrivers and limits diversity. Therefore, total abundance (N) is dependent on the total available resources. The early arrivers utilize resources and limits the amount available for later species limiting the overall total abundance. N will be heavily represented by these earlier species and limits diversity. 
Citation: https://myweb.ttu.edu/nmcintyr/Community%20Ecology/abundance.docx
> ***Answer 10b***:
>The niche preemption model looks extremely linear as it represents the limited diversity of a community due to the fact earlier species limit the available resources for later species. Therefore, there is a negative linear relationship between species arrival and resource occupancy. In the BCI plot, species that are more abundant species have a higher rank as they are classified as the early arrivals. As rank continues to decrease, species become less abundant. For the BCI site 1 data, preemption deviates by 21.8939. 
Citation: https://myweb.ttu.edu/nmcintyr/Community%20Ecology/abundance.docx



***Question 11***: Why is it important to account for the number of parameters a model uses when judging how well it explains a given set of data?

> ***Answer 11***:
>Parameters help ensure that the model fits the data accurately and with more parameters, the model should fit better. However, too many parameters may result in an overly specific model that is not reproducible for other studies and may capture noise leading to the actual patterns not being captured. With too few parameters, the model will be underfit and does not capture the patterns or complexity of the data.  It is important to account for the number of parameters used as too few or too many can result in poor fitting. 

## SYNTHESIS

1.  As stated by Magurran (2004) the  ${D = } \sum p_i^2$ derivation of Simpson's Diversity only applies to communities of infinite size. 
For anything but an infinitely large community, Simpson's Diversity index is calculated as ${D = } \sum \frac{n_i(n_i -1)} {N(N-1)}$. 
Assuming a finite community, calculate Simpson's D, 1 - D, and Simpson's inverse (i.e. 1/D) for `site 1` of the BCI site-by-species matrix. 
```{r}
#print(site1.BCI)
SimpD = function(x = ""){
  D=0
  N=sum(x)
  for (n_i in x){
    D =D +(n_i^2)/(N^2)
  }
  return(D)
}
D <-(site1.BCI)
D.inv <-1/SimpD(site1.BCI)
D.sub <-1-SimpD(site1.BCI)


simpD <-  data.frame(Diversity_Index = c("Simpson's D", "Inverse Simpson's D", "Complement of Simpson's D"),
  Species = c(D, D.inv, D.sub)
)
print(simpD)

```

2.  Along with the rank-abundance curve (RAC), another way to visualize the distribution of abundance among species is with a histogram (a.k.a., frequency distribution) that shows the frequency of different abundance classes.
For example, in a given sample, there may be 10 species represented by a single individual, 8 species with two individuals, 4 species with three individuals, and so on.
In fact, the rank-abundance curve and the frequency distribution are the two most common ways to visualize the species-abundance distribution (SAD) and to test species abundance models and biodiversity theories.
To address this homework question, use the R function **hist()** to plot the frequency distribution for `site 1` of the BCI site-by-species matrix, and describe the general pattern you see.


```{r}
site1.BCI.abundances <-BCI[,1]
print(site1.BCI.abundances)
hist(site1.BCI.abundances, 
     breaks = "Sturges",
     main = "Species Abundance Distribution at Site 1",
     xlab = "Number of Individuals per Species",
     ylab = "Frequency (Number of Species)",
     col ="cornflowerblue",
     border ="black")
```
>For Species Abundance Distribution at Site 1, there is a signficant right skew with a majority of the samples having zero indviduals. There is one species with an abundance of 1. Therefore, there is very low abundance at Site 1 n the BCI database. 

3.  We asked you to find a biodiversity dataset with your partner.
This data could be one of your own or it could be something that you obtained from the literature. 
Load that dataset.
How many sites are there?
How many species are there in the entire site-by-species matrix?
Any other interesting observations based on what you learned this week?

#This was having trouble knitting- I was switching between the console and r-chunk due to issues setting the working directory. I transformed
print(tree)
tree.df <-as.data.frame(tree)
print(tree.df)

tree.species.df <-data.frame(Plot_ID = c(tree$PLOT),
                             Species_ID =c(tree$SPCD))
print(tree.species.df)

print(tree.species.df$Plot_ID)

#Site by Species df 
library(dplyr)
library(tidyr)
library(tibble)

tree.species.df <- tree.species.df %>%
  mutate(Plot_ID = as.character(Plot_ID), Species_ID = as.character(Species_ID))
tree.ss.df <- as.data.frame.matrix(table(tree.species.df$Plot_ID, tree.species.df$Species_ID))
tree.ss.df <- rownames_to_column(tree.ss.df, var = "Plot_ID")
print(tree.ss.df)
tree.species.df <- tree.ss.df[, 2:ncol(tree.ss.df)]
#Overview
length(tree.species.df$Species_ID) 43528 species in the Tree dataset-species delimited by species ID ranging from 110-999 translation of the codes can be found in the repository
range(tree.species.df$Species_ID)
length(tree.species.df$Plot_ID) 43528 plots in the Tree dataset ranging from 1-999 translation of the codes can be found in the repository
range(tree.species.df$Plot_ID)
str(tree.species.df)
#This dataset is so large much of the diversity metrics will only printed a limited number of outputs. I will have the code for all the sites commented out with comparison at only one site (Site 1)
tree.site1.df <- as.data.frame(tree.ss.df[1,])
tree.site1.df$Plot_ID <- NULL
print(tree.site1.df)

#Observed Richness
S.obs(tree.site1.df) #Observed richenss = 2
obsRich.all <- S.obs(tree.ss.df) #Observed richness ranges from [2,12] for the enture dataset

#Good's Coverage
GC(tree.site1.df) #.889 GC
GC.tree.all <-GC(tree.species.df) #mean = .6391


chao1.tree.all <- chao1(tree.species.df) #range [17048.72, 17058.72] mean 17051.15

#as of 10:41 on 1/29/2025 I am pushing but will keep working- there is so much data I need some time to think on how I want to filter it so I can do appropriate analysis 




## SUBMITTING YOUR ASSIGNMENT
Use Knitr to create a PDF of your completed 5.AlphaDiversity_Worksheet.Rmd document, push it to GitHub, and create a pull request.
Please make sure your updated repo include both the pdf and RMarkdown files.

Unless otherwise noted, this assignment is due on **Wednesday, January 29^th^, 2025 at 12:00 PM (noon)**.